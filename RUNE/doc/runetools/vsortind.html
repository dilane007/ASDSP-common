<HTML>
<HEAD>
<TITLE>Manpage - vsortind</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>vsortind<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>indi=vsortind(xi,xv,dim)</P>
xi and xv will be expanded to equal size for all dimensions except dim For each value of xi an index is calculated so that the index to the maximum value of xv not exceeds the corresponding value in xi. The output will receive the combined size of xv and xi except for dimension dim where the size is that of xi Make shure that the input argument xv is either increasing or decreasing along the dimension dim. Note that first xv-value along dim has nothing to do with the result</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>xi</B></TD><TD>a real matrix for which index is going to be created.</TD></TR>
<TR><TD VALIGN="TOP"><B>xv</B></TD><TD>a real matrix that is either increasing or decreasing along dimension dim into which indi is pointingf</TD></TR>
<TR><TD VALIGN="TOP"><B>dim</B></TD><TD>dimension along xv in which index will be fitted</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>indi</B></TD><TD>A matrix with indices into xv such that xi &lt;= xv(indi)</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Try</FONT></TD>
<TD><PRE>x = 0:0.1:5; plot(x,vsortind(x, (1:4)'),'*')
x = 0:0.1:5; plot(x,vsortind(x', [1:4; 3:6]'),'*')
r = randn(10000,1); plot(r,vsortind(r,linspace(-2,2,7)'),'.')</PRE></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">See Also</FONT></TD>
<TD><A HREF="interp1n.html">interp1n</A>, interpndim, <A HREF="histn.html">histn</A>, <A HREF="histnw.html">histnw</A></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function indi = vsortind(xi,xv,dim)

<FONT COLOR="DARKGREEN">% by Magnus Almgren 030724</FONT>

<FONT COLOR="DARKGREEN">% Default dim is set the fisrt non singleton dimension of xv</FONT>
<A HREF="setifnotexist.html">setifnotexist</A>('dim',<A HREF="firstnonsing.html">firstnonsing</A>(xv));

if isempty(xi) <FONT COLOR="DARKGREEN">% empty in, empty out</FONT>
 indi = xi;
 return
end

<FONT COLOR="DARKGREEN">% Make sure that x is monotonic i.e. all(diff(xv,[],dim))>=0</FONT>
signdiffxv = sign(diff(xv,[],dim));
maxd = max(signdiffxv(:));
mind = min(signdiffxv(:));
if maxd-mind==2
 error('Second argument is both increasing and decreasing');
elseif mind==-1 <FONT COLOR="DARKGREEN">% all of x must be decrasing along dimension dim</FONT>
 xv = flipdim(xv,dim);
 flipped = 1;
else
 flipped = 0;
end

<FONT COLOR="DARKGREEN">% Adjust input argument sizes to match each other except for dimension dim</FONT>
[xi xv] = <A HREF="adjsizabdim.html">adjsizabdim</A>(dim,xi,xv);

<FONT COLOR="DARKGREEN">% Find ind such that xv(ind) is just beneath or equal to xi</FONT>
indi = ones(size(xi));
step = 2.^ceil(log2(size(xv,dim)));  <FONT COLOR="DARKGREEN">% the initial step size</FONT>
while step>1
 step =  max(1,step/2); <FONT COLOR="DARKGREEN">% decrease stepsize</FONT>
 indiprop = <A HREF="index1.html">index1</A>(min(size(xv,dim),indi + step),dim,size(xv)); 
 xvind = reshape(xv(indiprop),size(indiprop)); <FONT COLOR="DARKGREEN">% just due to the odd syntax of this language</FONT>
 indi = min(size(xv,dim),indi + step*(xi-xvind>=0)); <FONT COLOR="DARKGREEN">% eventually increase ind </FONT>
end

<FONT COLOR="DARKGREEN">% Turn index values around if flipped earlier on</FONT>
if flipped 
 indi = indi - size(xv,dim) + 1;
end

<FONT COLOR="DARKGREEN">% $Id: vsortind.m,v 1.2 2004/03/11 15:01:52 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>