<HTML>
<HEAD>
<TITLE>Manpage - pathgain</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>pathgain<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>g=pathgain(xym,xyb,fib,asps,rhombvec,gainconst,alpha,sigma,raa,lognmap,mapvec)</P>
Caluculates the gain in dB between all mobiles and all bases.</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>xym</B></TD><TD>Mobile coordinates, given as a complex column vector.</TD></TR>
<TR><TD VALIGN="TOP"><B>xyb</B></TD><TD>Base station coordinates, given as a complex row vector.</TD></TR>
<TR><TD VALIGN="TOP"><B>fib</B></TD><TD>Base station antenna vector, given as a row vector. Points in the antenna direction.</TD></TR>
<TR><TD VALIGN="TOP"><B>asps</B></TD><TD>Antenna Sectors per site 3 &lt;=&gt; 120 deg sector antenna, 1 &lt;=&gt; Omni antenna</TD></TR>
<TR><TD VALIGN="TOP"><B>rhombvec</B></TD><TD>Two complex vectors spanning the rhombic area containing cells.</TD></TR>
<TR><TD VALIGN="TOP"><B>gainconst</B></TD><TD>Gain at 1 meter distance.</TD></TR>
<TR><TD VALIGN="TOP"><B>alpha</B></TD><TD>Distance attenuation coefficient.</TD></TR>
<TR><TD VALIGN="TOP"><B>sigma</B></TD><TD>Standard deviation for the lognormal fading in dB.</TD></TR>
<TR><TD VALIGN="TOP"><B>raa</B></TD><TD>Down link correlation (typical 0.5). This parameter determines the correlation for the lognormal fading on the links between the base stations and one mobile.</TD></TR>
<TR><TD VALIGN="TOP"><B>lognmap</B></TD><TD>Lognormal map used to create lognormal fading.</TD></TR>
<TR><TD VALIGN="TOP"><B>mapvec</B></TD><TD>Two complex vectors that will determine the size of lognmap.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>g</B></TD><TD>Gain for all links in dB, given as a matrix one column for each base and one row for each mobile</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Try</FONT></TD>
<TD><PRE>rhombvec = exp([0 2*pi/3]*i)*10000;
gainconst = 21;
alfa = 3.5;
sigma = 0;
raa = 0.5;
[lognmap, lognmapvec] = crelognmap([],rhombvec,100);
Now. Only one mobile and one base station.
g = pathgain(0,0,1000,3,rhombvec,gainconst,alfa,sigma,raa,lognmap,lognmapvec)
xym = 1000*irandn(10,1); % ten users ramndomly placed
xyb = irand(1,2); % two base stations randomly placed
fib =  exp(i*100*rand(1,2)); % random antenna direction
asps = 3;
rhombvec = [0 0]; % no wrap around;
gainconst = 21;
alfa = 3.5;
sigma = 0;
raa = 0.5;
g = pathgain(  0,   1000,asps,rhombvec,gainconst,alfa,sigma)
g = pathgain(xym,xyb,fib,asps,rhombvec,gainconst,alfa,sigma)</PRE></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function g = pathgain(xym, xyb, fib, asps, rhombvec, gainconst, alpha, ...
                      sigma, raa, lognmap, mapvec)

<FONT COLOR="DARKGREEN">% SEE ALSO </FONT>
<FONT COLOR="DARKGREEN">%  crelognmap, uselognmap, crecluster</FONT>

<FONT COLOR="DARKGREEN">% by Magnus ALmgren 000510 revised 040202</FONT>

if isempty(xym)
 g = zeros(0,size(xyb,2)); <FONT COLOR="DARKGREEN">% Set to an empty matrix.</FONT>
 return
end

<FONT COLOR="DARKGREEN">% Wrap around in 7 positions. </FONT>
r = 0;  
if sum(abs(rhombvec))>0 <FONT COLOR="DARKGREEN">% no rhombvec, no wrap around</FONT>
 r = <A HREF="../runetools/flatten.html">flatten</A>(<A HREF="crecluster.html">crecluster</A>(1,2,rhombvec(1)),3); <FONT COLOR="DARKGREEN">% wrap 7 possible positions</FONT>
end

<FONT COLOR="DARKGREEN">% xymbr = wrapinto(mplus(xym, -xyb),rhombvec,'hex'));</FONT>
<FONT COLOR="DARKGREEN">% wad = mplus(xymbr, r);</FONT>
wad = <A HREF="../runetools/mplus.html">mplus</A>(xym, -xyb, r);

<FONT COLOR="DARKGREEN">% Distance gain</FONT>
<FONT COLOR="DARKGREEN">% Make sure that the used distance is not less than 10 meters.</FONT>
gatt = <A HREF="../runetools/mplus.html">mplus</A>(gainconst, -<A HREF="../runetools/mprod.html">mprod</A>(alpha ,<A HREF="../runetools/lin2db.html">lin2db</A>(max(10,abs(wad)))));

<FONT COLOR="DARKGREEN">% Angle attenuation between direction to mobiles and cell main direction added.</FONT>
gant = <A HREF="antennagain.html">antennagain</A>(angle(<A HREF="../runetools/mdiv.html">mdiv</A>(fib,wad)),1/asps);

<FONT COLOR="DARKGREEN">% Select the position with highest gain of all wrap positions</FONT>
g = max(gant+gatt,[],3);
clear gatt; <FONT COLOR="DARKGREEN">% These may be big. </FONT>
clear gant;
clear wad;

<FONT COLOR="DARKGREEN">% Lognormal fading with base station correlation.</FONT>
if sigma ~=0
 <FONT COLOR="DARKGREEN">% Create a random base offset.</FONT>
 oseed = <A HREF="../runetools/setseed.html">setseed</A>(1); 
 maxdist = max(<A HREF="../runetools/flatten.html">flatten</A>(abs(<A HREF="../runetools/mplus.html">mplus</A>(xyb,-xyb.')))); <FONT COLOR="DARKGREEN">% max distance </FONT>
 xyboffs = <A HREF="../runetools/irand.html">irand</A>(size(xyb))*maxdist*10; <FONT COLOR="DARKGREEN">% scramble base pos</FONT>
 <A HREF="../runetools/setseed.html">setseed</A>(oseed);
 <FONT COLOR="DARKGREEN">% Calculate the log normal gain</FONT>
 g = g + sigma * <A HREF="../runetools/mplus.html">mplus</A>(... 
  sqrt(1-raa) * <A HREF="uselognmap.html">uselognmap</A>(<A HREF="../runetools/mplus.html">mplus</A>(-xym,xyboffs),lognmap,mapvec), ...
  sqrt(raa)   * <A HREF="uselognmap.html">uselognmap</A>(       xym         ,lognmap,mapvec) ...
  );
end

<FONT COLOR="DARKGREEN">% $Id: pathgain.m,v 1.2 2004/03/11 15:01:31 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>