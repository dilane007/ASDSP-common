<HTML>
<HEAD>
<TITLE>Manpage - creraylmap</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>creraylmap<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>[raylmap,raylmapvec]=creraylmap(rhombvec,lambda,nlayer)</P>
Creates a rayleigh fading map with complex samples. The map is generated by filtering white noise through a bessel function. This is made with a fourirer method that will make the map periodic. This property is used by useraylmap.m to cover the simulated area with a rayleighpattern much like a wall paper. mapvec is an integer fraction of rhombvec. rhombvec are two complex vectors that span the simulated area.</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>rhombvec</B></TD><TD>The size of the area that is going to be covered by the map. Two complex vectors spanning the simulated area.</TD></TR>
<TR><TD VALIGN="TOP"><B>lambda</B></TD><TD>The wavelength in meter.</TD></TR>
<TR><TD VALIGN="TOP"><B>nlayer</B></TD><TD>The number of maps to be created ( Layered in 3rd dimension.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>raylmap</B></TD><TD>A small map with rayleigh samples that is used by the function useraylmap to create the actual multipath fading. The map spans atleast two dimensions and possbly also the 3rd to store nlayer independent maps</TD></TR>
<TR><TD VALIGN="TOP"><B>raylmapvec</B></TD><TD>Two complex elements spanning the area of the map. The first element spans the first dimension and the second element the second dimension.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Try</FONT></TD>
<TD><PRE>mesh(2*lin2db(abs(creraylmap([1 i]*1000))))</PRE></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">See Also</FONT></TD>
<TD><A HREF="useraylmap.html">useraylmap</A></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function [raylmap, raylmapvec] = creraylmap(rhombvec,lambda,nlayer)

<FONT COLOR="DARKGREEN">% by Magnus Almgren 031116</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('rhombvec','1000*[1 exp(i*2*pi/3)]'); <FONT COLOR="DARKGREEN">% System mapsize</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('lambda',3e8/2e9); <FONT COLOR="DARKGREEN">% Wavelenth [m]</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('nlayer',1); <FONT COLOR="DARKGREEN">% Number of independent map (3rd dimension of raylmap)  </FONT>

<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('seed',2); <FONT COLOR="DARKGREEN">% seed for the generated map</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('angmean',pi/2); <FONT COLOR="DARKGREEN">% angle towards cluster</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('angsig',inf); <FONT COLOR="DARKGREEN">% angular standard deviation of sources</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('N',2.^4); <FONT COLOR="DARKGREEN">%  Number of samples in phase spectrum</FONT>
<A HREF="../runetools/setifnotexistorempty.html">setifnotexistorempty</A>('M',2.^4); <FONT COLOR="DARKGREEN">% Oversampling for the ifft. Makes the map smooth</FONT>

if nlayer==0 <FONT COLOR="DARKGREEN">% don't generate the map in this case</FONT>
 raylmap = 0;
 raylmapvec = 0;
 return
end

<FONT COLOR="DARKGREEN">% nn -- The number of times to repeat the map along rhombvec</FONT>
margin = 0.1; <FONT COLOR="DARKGREEN">% relative margin to the border of the map</FONT>
n = imag(rhombvec(2)/(rhombvec(1)/abs(rhombvec(1))))/2/lambda;
nn = floor(n/(1+margin)); <FONT COLOR="DARKGREEN">% </FONT>

<FONT COLOR="DARKGREEN">% vectors spanning the map</FONT>
raylmapvec(:,1) = linspace(0,rhombvec(1)/nn,N*M+1).';
raylmapvec(:,2) = linspace(0,rhombvec(2)/nn,N*M+1).'; 

<FONT COLOR="DARKGREEN">% raylmap -- 1st and 2nd dimension <=> space, 3rd dimnension <=> timedelay</FONT>
[raylmap, sqfs] = <A HREF="creraylangmap.html">creraylangmap</A>(seed,angmean,angsig,N,M,raylmapvec(end,:),lambda,nlayer);

<FONT COLOR="DARKGREEN">% extend the map for wraparound linear interpolation in all dimensions</FONT>
raylmap = raylmap([1:end 1],[1:end 1],:);

<FONT COLOR="DARKGREEN">% $Id: creraylmap.m,v 1.2 2004/03/11 15:01:31 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>