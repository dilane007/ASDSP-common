<HTML>
<HEAD>
<TITLE>Manpage - uselognmap</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>uselognmap<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>logn=uselognmap(pos,lognmap,mapvec)</P>
Generates correlated lognormal values that are position dependent. This routine is closely related to crelognmap.m</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>pos</B></TD><TD>Any matrix with complex positions. Values are folded back into the map when outside</TD></TR>
<TR><TD VALIGN="TOP"><B>lognmap</B></TD><TD>Global variable containing the lognormal map.</TD></TR>
<TR><TD VALIGN="TOP"><B>mapvec</B></TD><TD>Two complex vector elements describing the size of the map</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>logn</B></TD><TD>Value of lognormal fading. Same size as the &quot;pos&quot; input argument</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">See Also</FONT></TD>
<TD><A HREF="crelognmap.html">crelognmap</A></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function logn = uselognmap(pos, lognmap, mapvec)

<FONT COLOR="DARKGREEN">% by Magnus Almgren 960508, revised 991101</FONT>

<FONT COLOR="DARKGREEN">% the same border must be used as when the map was create</FONT>
border = 1; <FONT COLOR="DARKGREEN">% extension for cubic interpolation</FONT>
siz = size(lognmap,1)-2*border; <FONT COLOR="DARKGREEN">% size of side of map</FONT>

<FONT COLOR="DARKGREEN">% the inverse base of v (v(1)*base => [1 0] and v(2)*base => [0 1] </FONT>
base = inv([real(mapvec.') imag(mapvec.')]);

<FONT COLOR="DARKGREEN">% the portions of v(1) and v(2) for each position element</FONT>
rpos = [real(pos(:)) imag(pos(:))];

<FONT COLOR="DARKGREEN">% wrap it  back into the interval {0,1}</FONT>
mpos = mod(rpos*base,1);
pos1 = reshape(mpos(:,1), size(pos));
pos2 = reshape(mpos(:,2), size(pos));

<FONT COLOR="DARKGREEN">% vectors used by interp2 for table lookup </FONT>
mapi = (-1:siz)/siz;


<FONT COLOR="DARKGREEN">% make the interpolation</FONT>
if size(lognmap,3)==1
 logn = interp2(mapi, mapi, lognmap.', pos2, pos1);
else
 for j = 1:size(lognmap,3) <FONT COLOR="DARKGREEN">% store as an cellarrarray</FONT>
  logn{j} = interp2(mapi, mapi, lognmap(:,:,j).', pos2, pos1);
 end
end

<FONT COLOR="DARKGREEN">% $Id: uselognmap.m,v 1.2 2004/03/11 15:01:31 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>