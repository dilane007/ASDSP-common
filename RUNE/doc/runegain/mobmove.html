<HTML>
<HEAD>
<TITLE>Manpage - mobmove</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>mobmove<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>[xym,xyv]=mobmove(xym,xyv,amean,vmean,dt,rhombvec)</P>
Move and initiate position of users.</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>xym</B></TD><TD>Complex position of users possibly. NaN for users that have not yet received any position and thus are regarded as new.</TD></TR>
<TR><TD VALIGN="TOP"><B>xyv</B></TD><TD>Complex speed [m/s].</TD></TR>
<TR><TD VALIGN="TOP"><B>amean</B></TD><TD>Average acceleration of mobiles.</TD></TR>
<TR><TD VALIGN="TOP"><B>vmean</B></TD><TD>Mean speed of mobiles.</TD></TR>
<TR><TD VALIGN="TOP"><B>dt</B></TD><TD>Time interval since last call to this routine.</TD></TR>
<TR><TD VALIGN="TOP"><B>rhombvec</B></TD><TD>Two complex vectors determining the area within which mobiles are folded.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>xym</B></TD><TD>New position.</TD></TR>
<TR><TD VALIGN="TOP"><B>xyv</B></TD><TD>New speed.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Try</FONT></TD>
<TD><PRE>plot(mobmove(zeros(1000,1),zeros(1000,1),1,10,1,[1 i]*1000),'.')
plot(mobmove(zeros(1000,1),zeros(1000,1),1,10,1,[1 i]*1),'.')
plot(mobmove(nans(1000,1),zeros(1000,1),1,10,1,[1+i i]*1000),'.')</PRE></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function [xym,xyv] = mobmove(xym,xyv,amean,vmean,dt,rhombvec)

<FONT COLOR="DARKGREEN">% by Magnus Almgren 000505, dt<=0 MA 010516</FONT>

<FONT COLOR="DARKGREEN">% Move users.</FONT>
if dt>0
 raa = exp(-<A HREF="../runetools/mdiv.html">mdiv</A>(dt.*amean,vmean));
 <FONT COLOR="DARKGREEN">% raa is the correlation between the new and the old xyv</FONT>
 <FONT COLOR="DARKGREEN">% and does not impact the variance.</FONT>
 xyv = xyv.*raa+sqrt(1-raa.^2).*vmean/sqrt(pi/2).*<A HREF="../runetools/irandn.html">irandn</A>(size(xyv));
 xym = xym + xyv.*dt;
end
<FONT COLOR="DARKGREEN">% Give new users speed and position.</FONT>
newones = isnan(xym);

<FONT COLOR="DARKGREEN">% Generate position and wrap into simulated area.</FONT>
xym(newones)= 0;
if exist('rhombvec','var') & sum(abs(rhombvec))>0
 xym(newones) = rand(size(xyv(newones),1),2)*rhombvec(:);
 xym = <A HREF="wrapinto.html">wrapinto</A>(xym,rhombvec,'hex');
end

<FONT COLOR="DARKGREEN">% Init speed.</FONT>
xyv(newones) = vmean/sqrt(pi/2).*<A HREF="../runetools/irandn.html">irandn</A>(size(xyv(newones))); 

return

xym = xym(:); <FONT COLOR="DARKGREEN">% Put into first dimension. Is that necessary?</FONT>
xyv = xyv(:);

<FONT COLOR="DARKGREEN">% $Id: mobmove.m,v 1.2 2004/03/11 15:01:31 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>