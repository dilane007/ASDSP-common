<HTML>
<HEAD>
<TITLE>Manpage - crecluster</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>crecluster<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>[xys,clv]=crecluster(km,lm,d)</P>
Creates one cluster containing km^2 + lm^2 + km*lm sites. These terms are handled as three parallellograms and then combined to a cluster.</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>km</B></TD><TD>See below.</TD></TR>
<TR><TD VALIGN="TOP"><B>lm</B></TD><TD>Integer. At least one of km and lm is &gt;0.</TD></TR>
<TR><TD VALIGN="TOP"><B>d</B></TD><TD>Complex vector to nearest site. Default 1.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>xys</B></TD><TD>The positions of the sites in complex coordinates.</TD></TR>
<TR><TD VALIGN="TOP"><B>clv</B></TD><TD>Two vectors used to repeat clusters next to each other. The vectors tells the displcement in complex coordinates from the cluster to its nearest copies.</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Try</FONT></TD>
<TD><PRE>[xys, clustervecs] = crecluster(2,3), plot(xys,'*')
figure, plot(mplus(xys.',[0 -clustervecs clustervecs]),'*')
plot(crecluster(4,5),'.-')</PRE></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function [xys, clv] = crecluster(km,lm,d)

<FONT COLOR="DARKGREEN">% by Magnus Almgren 990716 revised 031114 MA</FONT>

<FONT COLOR="DARKGREEN">% Set defaults</FONT>
if nargin < 2, lm = km+1; end
if nargin < 3,  d = 1;    end

e = exp(i*2/3*pi*(0:2));   <FONT COLOR="DARKGREEN">% vectors used to span the cluster</FONT>

kv = 0:km-1; 
lv = 0:lm-1;

[m1 m2] = meshgrid(kv*e(1),kv*e(2)); <FONT COLOR="DARKGREEN">% meshgrid can handle [], mplus can not</FONT>
skk = <A HREF="../runetools/flatten.html">flatten</A>(m1+m2)-e(3);

[m1 m2] = meshgrid(lv*e(1),lv*e(3));
sll = <A HREF="../runetools/flatten.html">flatten</A>(m1+m2);

[m1 m2] = meshgrid(kv*e(2),lv*e(3));
slk = <A HREF="../runetools/flatten.html">flatten</A>(m1+m2)+e(2);

clv = (km*e(1)-lm*e(3))*[1 e(2)].*d;
xys = [sll(:).' skk(:).' slk(:).'].*d;

<FONT COLOR="DARKGREEN">% $Id: crecluster.m,v 1.2 2004/03/11 15:01:31 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>