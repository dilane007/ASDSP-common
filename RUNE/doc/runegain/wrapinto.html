<HTML>
<HEAD>
<TITLE>Manpage - wrapinto</TITLE>
</HEAD>

<BODY BGCOLOR="WHITE">

<CENTER><TABLE CELLSPACING=5 BORDER=0><TR><TD BGCOLOR="#A0A0A0" COLSPAN=2><UL>
<FONT SIZE=6 FACE="sans-serif"><B>wrapinto<B></FONT>
</UL></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Description</FONT></TD>
<TD WIDTH=500><P>wxym=wrapinto(xym,rhombvec,type)</P>
Matrix xym with complex elements will be wrapped into a rhomb that is generated by the two complex elements of rhombvec if type is equal to the string 'rhomb'. In the same way xym will be wrapped into a hexagon if type is equal to 'hex'.</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Input</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>xym</B></TD><TD>Position that should be wraped into the area</TD></TR>
<TR><TD VALIGN="TOP"><B>rhombvec</B></TD><TD>A vector describing the rhombic area</TD></TR>
<TR><TD VALIGN="TOP"><B>type</B></TD><TD>'hex' or 'rhomb'</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Output</FONT></TD>
<TD><TABLE BORDER=0 CELLSPACING=5 WIDTH=500><TR><TD VALIGN="TOP"><B>wxym</B></TD><TD>New positions in the rhombic area</TD></TR>
</TABLE>
</TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2">Try</FONT></TD>
<TD><PRE>plot(wrapinto(10*irandn(10000,1),exp(i*pi*[0 1]/3),'hex'),'.')
axis equal
plot(wrapinto(10*irandn(10000,1),exp(i*pi*[0 1]/3),'rhomb'),'.')
axis equal</PRE></TD></TR>
<TR><TD COLSPAN=2 HEIGHT=6><FONT SIZE="-7">&nbsp;</FONT></TD></TR>

<TR><TD VALIGN="TOP"><FONT SIZE="+2" COLSPAN=2>Source Code</TD></TR>
<TR><TD COLSPAN=2><PRE>function  wxym = wrapinto(xym, rhombvec, type)

<FONT COLOR="DARKGREEN">% by Magnus Almgren 991122</FONT>

<FONT COLOR="DARKGREEN">% the inverse base of rhombvec. rhombvec(1)*base=>[1 0] rhombvec(2)*base=>[0 1] </FONT>
base = inv([real(rhombvec.') imag(rhombvec.')]);
rwa = [real(xym(:)) imag(xym(:))];  <FONT COLOR="DARKGREEN">% first column real part and second imaginary</FONT>

<FONT COLOR="DARKGREEN">% wrap it back into the rhomb </FONT>
twa = rwa*base;
wxyv = mod(twa,1)*rhombvec.';
<FONT COLOR="DARKGREEN">%wxyv = (twa - round(twa))*rhombvec.';</FONT>
if strcmp(type,'hex')
 <FONT COLOR="DARKGREEN">% wrap to shortest distance from origo (possibly a hexagon)</FONT>
 rwcomb = <A HREF="../runetools/mplus.html">mplus</A>((-1:0)*rhombvec(1),(-1:0)'*rhombvec(2));
 if ~isempty(wxyv)
  wxyv = min(<A HREF="../runetools/mplus.html">mplus</A>(wxyv,rwcomb(:).'),[],2);
 end  
end
wxym = reshape(wxyv,size(xym));

<FONT COLOR="DARKGREEN">% $Id: wrapinto.m,v 1.2 2004/03/11 15:01:31 olav Exp $</FONT>
</PRE></TD></TR>
</TABLE></CENTER>
</BODY>
</HTML>